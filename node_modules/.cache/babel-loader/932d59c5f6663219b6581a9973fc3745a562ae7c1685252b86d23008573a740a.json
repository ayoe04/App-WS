{"ast":null,"code":"var _jsxFileName = \"/home/ayu/Documents/project-ayu/app-wrap-station/src/dashboard.jsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$(),\n  _s3 = $RefreshSig$(),\n  _s4 = $RefreshSig$();\nimport React, { useState, useCallback, useEffect, useRef } from 'react';\n// PERBAIKAN: Mengganti impor untuk versi modular\nimport { getAuth, signInAnonymously, signInWithCustomToken } from 'firebase/auth';\nimport { initializeApp } from 'firebase/app';\nimport { getFirestore, collection, doc, setDoc, query, onSnapshot, orderBy, where, addDoc } from 'firebase/firestore';\nimport { X, CheckCircle, Car, DollarSign, ListChecks, FileText, User } from 'lucide-react';\n\n// --- KONFIGURASI FIREBASE ---\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';\n\n// Perbaikan: Amankan proses JSON.parse dengan pengecekan tambahan\nlet firebaseConfig = {};\ntry {\n  // Hanya parse jika variabel didefinisikan dan bukan string kosong\n  if (typeof __firebase_config !== 'undefined' && __firebase_config) {\n    firebaseConfig = JSON.parse(__firebase_config);\n  }\n} catch (e) {\n  console.error(\"Gagal mem-parsing Firebase config:\", e);\n}\nconst initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;\nlet app;\nlet db;\nlet auth;\ntry {\n  if (Object.keys(firebaseConfig).length > 0) {\n    // Memastikan initializeApp hanya dipanggil sekali\n    if (!app) {\n      app = initializeApp(firebaseConfig);\n      db = getFirestore(app);\n      auth = getAuth(app);\n    }\n  } else {\n    console.error(\"Firebase config is missing or invalid. App will not use Firestore.\");\n  }\n} catch (error) {\n  console.error(\"Failed to initialize Firebase:\", error);\n}\n\n// Fungsi untuk mendapatkan path koleksi Firestore\nconst getCollectionPath = (userId, collectionName) => {\n  // Kita simpan data inspeksi secara private per user\n  return `/artifacts/${appId}/users/${userId}/${collectionName}`;\n};\n\n// --- Komponen Pembantu ---\n\nconst ImageInput = ({\n  inspectionId,\n  file,\n  handleFormChange\n}) => {\n  _s();\n  const fileInputRef = useRef(null);\n  const handleFileChange = e => {\n    const fileObj = e.target.files[0];\n    if (fileObj) {\n      const reader = new FileReader();\n      reader.onloadend = () => {\n        // PERBAIKAN: Pastikan untuk mempertahankan status dan notes saat file baru diunggah\n        const existingDetails = file ? {\n          status: file.status || 'G',\n          notes: file.notes || ''\n        } : {\n          status: 'G',\n          notes: ''\n        };\n        handleFormChange('inspection', inspectionId, {\n          ...existingDetails,\n          file: {\n            name: fileObj.name,\n            dataUrl: reader.result // Data URL (Base64) untuk dikirim ke backend\n          }\n        });\n      };\n      reader.readAsDataURL(fileObj);\n    }\n  };\n  const handleRemoveImage = () => {\n    // PERBAIKAN: Pertahankan status dan notes saat menghapus file\n    const existingDetails = file ? {\n      status: file.status || 'G',\n      notes: file.notes || ''\n    } : {\n      status: 'G',\n      notes: ''\n    };\n    handleFormChange('inspection', inspectionId, {\n      ...existingDetails,\n      file: null\n    });\n    if (fileInputRef.current) {\n      fileInputRef.current.value = \"\"; // Reset input file\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"flex flex-col items-start space-y-2 mt-2\",\n    children: [/*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"file\",\n      accept: \"image/*\",\n      onChange: handleFileChange,\n      ref: fileInputRef,\n      className: \"text-sm text-gray-700 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 7\n    }, this), file && file.dataUrl && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-center space-x-3 p-2 bg-gray-50 rounded-lg max-w-full\",\n      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"text-xs font-medium text-gray-600 truncate max-w-xs\",\n        children: file.name || 'Image Uploaded'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"button\",\n        onClick: handleRemoveImage,\n        className: \"text-red-500 hover:text-red-700 transition duration-150\",\n        children: /*#__PURE__*/_jsxDEV(X, {\n          size: 16\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 103,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 87,\n    columnNumber: 5\n  }, this);\n};\n\n// KOMPONEN INI YANG DIPERBAIKI\n_s(ImageInput, \"YQqvMxdmg33cmOXmQcOjJm+FLVI=\");\n_c = ImageInput;\nconst RatingInput = ({\n  inspectionId,\n  details,\n  handleFormChange\n}) => {\n  _s2();\n  // PERBAIKAN: Gunakan state untuk mengontrol visibilitas note secara lokal\n  // Tetapi inisialisasikan dari notes yang sudah ada (jika ada)\n  const [showNote, setShowNote] = useState(details.notes || details.file);\n\n  // Perbaikan: Pastikan inspectionId digunakan untuk mengubah state\n  const setRating = rating => {\n    handleFormChange('inspection', inspectionId, {\n      ...details,\n      status: rating\n    });\n  };\n\n  // Perbaikan: Pastikan inspectionId digunakan untuk mengubah state\n  const setNote = e => {\n    handleFormChange('inspection', inspectionId, {\n      ...details,\n      notes: e.target.value\n    });\n  };\n  const toggleNote = () => {\n    setShowNote(prev => !prev);\n  };\n  const statusColors = {\n    G: 'bg-green-500 hover:bg-green-600',\n    F: 'bg-yellow-500 hover:bg-yellow-600',\n    P: 'bg-red-500 hover:bg-red-600'\n  };\n\n  // Menampilkan deskripsi status\n  const statusDescriptions = {\n    G: 'Baik (Good)',\n    F: 'Cukup (Fair)',\n    P: 'Buruk (Poor)'\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"p-4 border border-gray-200 rounded-xl mb-4 bg-white shadow-sm\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex flex-col sm:flex-row justify-between items-start sm:items-center\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center space-x-3 mb-3 sm:mb-0\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-lg font-bold text-gray-800 flex-shrink-0\",\n          children: inspectionId\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 148,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-sm text-gray-500\",\n          children: [\"(\", statusDescriptions[details.status], \")\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 149,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 147,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center space-x-3\",\n        children: [['G', 'F', 'P'].map(rating => /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"button\",\n          onClick: () => setRating(rating),\n          className: `w-10 h-10 rounded-full font-bold text-white transition duration-200 ${details.status === rating ? statusColors[rating] : 'bg-gray-300 hover:bg-gray-400'}`,\n          children: rating\n        }, rating, false, {\n          fileName: _jsxFileName,\n          lineNumber: 154,\n          columnNumber: 13\n        }, this)), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"button\",\n          onClick: toggleNote,\n          className: \"px-4 py-2 bg-indigo-500 text-white text-sm font-medium rounded-full hover:bg-indigo-600 transition duration-150 shadow-md flex-shrink-0\",\n          children: showNote ? 'Sembunyikan Catatan' : 'Tambah Catatan/Foto'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 166,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 152,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 7\n    }, this), showNote && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mt-4 p-3 bg-indigo-50 rounded-lg\",\n      children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n        value: details.notes,\n        onChange: setNote,\n        placeholder: `Tambahkan catatan untuk ${inspectionId}...`,\n        rows: \"3\",\n        className: \"w-full p-2 border border-indigo-200 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 text-gray-700\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 178,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(ImageInput, {\n        inspectionId: inspectionId,\n        file: details.file,\n        handleFormChange: handleFormChange\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 185,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 145,\n    columnNumber: 5\n  }, this);\n};\n\n// Komponen untuk Tanda Tangan\n_s2(RatingInput, \"mb/fgXBSM9oCvTPOoae8AmznxP8=\");\n_c2 = RatingInput;\nconst SignatureForm = ({\n  formData,\n  handleFormChange,\n  onSubmit,\n  isLoading\n}) => {\n  _s3();\n  const canvasRef = useRef(null);\n  const [isDrawing, setIsDrawing] = useState(false);\n  // PERBAIKAN: Gunakan hasDrawn untuk mengontrol visibilitas tombol hapus\n  const [hasDrawn, setHasDrawn] = useState(!!formData.signature);\n\n  // Fungsi untuk membersihkan canvas dan mengisi dengan warna putih\n  const clearCanvas = (ctx, canvas) => {\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n    ctx.fillStyle = '#ffffff';\n    ctx.fillRect(0, 0, canvas.width, canvas.height);\n  };\n\n  // Fungsi yang memuat gambar tanda tangan dari state ke canvas\n  const redrawSignatureFromState = useCallback(signatureDataUrl => {\n    const canvas = canvasRef.current;\n    if (!canvas || !signatureDataUrl) return;\n    const ctx = canvas.getContext('2d');\n\n    // 1. Bersihkan canvas\n    clearCanvas(ctx, canvas);\n\n    // 2. Gambar ulang tanda tangan\n    const img = new Image();\n    img.onload = () => {\n      // Pastikan gambar digambar pada ukuran canvas saat ini\n      ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\n    };\n    img.src = signatureDataUrl;\n    setHasDrawn(true);\n  }, []);\n\n  // Efek untuk Inisialisasi Canvas dan Redraw\n  useEffect(() => {\n    const canvas = canvasRef.current;\n    if (!canvas) return;\n\n    // Set canvas resolution based on display size for clear rendering\n    const rect = canvas.getBoundingClientRect();\n    canvas.width = rect.width;\n    canvas.height = rect.height;\n    const ctx = canvas.getContext('2d');\n\n    // Inisialisasi dengan latar belakang putih\n    clearCanvas(ctx, canvas);\n\n    // Redraw tanda tangan dari state jika ada\n    if (formData.signature) {\n      redrawSignatureFromState(formData.signature);\n    }\n  }, [formData.signature, redrawSignatureFromState]); // Hapus isDrawing dari dependencies, agar tidak redraw saat menggambar\n\n  // Menggambar saat mouse/sentuhan bergerak\n  const drawSignature = useCallback((e, isTouch = false) => {\n    if (!isDrawing) return;\n    const canvas = canvasRef.current;\n    if (!canvas) return;\n    const ctx = canvas.getContext('2d');\n    const rect = canvas.getBoundingClientRect();\n    const x = isTouch ? e.touches[0].clientX - rect.left : e.clientX - rect.left;\n    const y = isTouch ? e.touches[0].clientY - rect.top : e.clientY - rect.top;\n    ctx.lineWidth = 2;\n    ctx.lineCap = 'round';\n    ctx.strokeStyle = '#000000';\n    ctx.lineTo(x, y);\n    ctx.stroke();\n    ctx.beginPath();\n    ctx.moveTo(x, y);\n\n    // Perbarui hasDrawn setelah menggambar\n    setHasDrawn(true);\n  }, [isDrawing]);\n\n  // Memulai menggambar\n  const handleStart = useCallback((e, isTouch) => {\n    if (isTouch) e.preventDefault();\n    setIsDrawing(true);\n    const canvas = canvasRef.current;\n    if (!canvas) return;\n    const ctx = canvas.getContext('2d');\n    const rect = canvas.getBoundingClientRect();\n    const x = isTouch ? e.touches[0].clientX - rect.left : e.clientX - rect.left;\n    const y = isTouch ? e.touches[0].clientY - rect.top : e.clientY - rect.top;\n\n    // Mulai path baru\n    ctx.beginPath();\n    ctx.moveTo(x, y);\n  }, []);\n\n  // Mengakhiri menggambar dan menyimpan ke state\n  const handleEnd = useCallback(() => {\n    if (isDrawing) {\n      setIsDrawing(false);\n      const canvas = canvasRef.current;\n      if (canvas) {\n        // Simpan tanda tangan yang baru digambar sebagai Data URL\n        const dataUrl = canvas.toDataURL('image/png');\n        // PERBAIKAN: Hanya simpan jika ada gambar yang benar-benar ditarik (lebih dari sekadar latar belakang putih)\n        const blankCanvasDataUrl = canvas.toDataURL('image/png').replace(/^data:image\\/png;base64,/, '');\n\n        // Tanda tangan dianggap valid jika dataUrl berbeda secara signifikan dari canvas kosong\n        // Ini adalah pengecekan sederhana, dataUrl kanvas kosong yang baru dibersihkan biasanya sangat pendek.\n        // Jika dataUrl lebih dari panjang tertentu, kita anggap itu tanda tangan\n        if (dataUrl.length > 5000) {\n          handleFormChange('root', 'signature', dataUrl);\n        } else {\n          handleFormChange('root', 'signature', ''); // Jika hanya kanvas kosong\n          setHasDrawn(false);\n        }\n      }\n    }\n  }, [isDrawing, handleFormChange]);\n  const clearSignature = () => {\n    const canvas = canvasRef.current;\n    if (canvas) {\n      const ctx = canvas.getContext('2d');\n      clearCanvas(ctx, canvas); // Bersihkan tampilan canvas\n      handleFormChange('root', 'signature', ''); // Kosongkan state\n      setHasDrawn(false);\n    }\n  };\n\n  // Efek untuk mengatur Event Listeners (hanya sekali saat mount)\n  useEffect(() => {\n    const canvas = canvasRef.current;\n    if (!canvas) return;\n    const mouseMoveHandler = e => drawSignature(e, false);\n    const touchMoveHandler = e => drawSignature(e, true);\n    const mouseDownHandler = e => handleStart(e, false);\n    const touchStartHandler = e => handleStart(e, true);\n    const mouseUpHandler = () => handleEnd();\n    const touchEndHandler = () => handleEnd();\n\n    // Pasang Event Listeners\n    canvas.addEventListener('mousedown', mouseDownHandler);\n    canvas.addEventListener('mousemove', mouseMoveHandler);\n    // document untuk menangkap mouseup di luar canvas\n    document.addEventListener('mouseup', mouseUpHandler);\n    canvas.addEventListener('touchstart', touchStartHandler, {\n      passive: false\n    }); // Gunakan passive: false untuk preventDefault di handleStart\n    canvas.addEventListener('touchmove', touchMoveHandler, {\n      passive: false\n    });\n    // document untuk menangkap touchend di luar canvas\n    document.addEventListener('touchend', touchEndHandler);\n\n    // Cleanup event listeners\n    return () => {\n      canvas.removeEventListener('mousedown', mouseDownHandler);\n      canvas.removeEventListener('mousemove', mouseMoveHandler);\n      document.removeEventListener('mouseup', mouseUpHandler);\n      canvas.removeEventListener('touchstart', touchStartHandler);\n      canvas.removeEventListener('touchmove', touchMoveHandler);\n      document.removeEventListener('touchend', touchEndHandler);\n    };\n  }, [drawSignature, handleStart, handleEnd]); // dependencies ini harus tetap ada\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"p-6 bg-white rounded-xl shadow-lg mt-6\",\n    children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n      className: \"text-xl font-bold text-gray-800 mb-4\",\n      children: \"Tanda Tangan Pelanggan\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 371,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"relative border border-gray-300 rounded-lg overflow-hidden\",\n      children: [/*#__PURE__*/_jsxDEV(\"canvas\", {\n        ref: canvasRef,\n        className: \"w-full h-48 bg-white cursor-crosshair\",\n        style: {\n          touchAction: 'none'\n        } // Mencegah scrolling browser saat menggambar\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 373,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"button\",\n        onClick: clearSignature\n        // PERBAIKAN: Kontrol visibilitas tombol hapus menggunakan state hasDrawn\n        ,\n        className: `absolute top-2 right-2 p-2 rounded-full transition duration-150 ${hasDrawn ? 'bg-red-100 text-red-600 hover:bg-red-200 opacity-100' : 'opacity-0 pointer-events-none'}`,\n        title: \"Hapus Tanda Tangan\",\n        children: /*#__PURE__*/_jsxDEV(X, {\n          size: 20\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 387,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 378,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 372,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mt-4 flex items-start\",\n      children: [\" \", /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"checkbox\",\n        id: \"agreeTerms\",\n        checked: formData.agreed,\n        onChange: e => handleFormChange('root', 'agreed', e.target.checked),\n        className: \"h-5 w-5 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500 flex-shrink-0 mt-1\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 392,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"agreeTerms\",\n        className: \"ml-3 text-base text-gray-700 font-medium\",\n        children: \"Saya telah membaca dan menyetujui Syarat & Ketentuan.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 399,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 391,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 370,\n    columnNumber: 5\n  }, this);\n};\n\n// Komponen Utama: Form Inspeksi\n_s3(SignatureForm, \"+Aukr8ffqrItvOfLgqzaYNSmX6I=\");\n_c3 = SignatureForm;\nconst InspectionForm = ({\n  formData,\n  handleFormChange,\n  goToNext,\n  goToPrev\n}) => {\n  // Hanya mendefinisikan item-item inspeksi\n  const inspectionItems = ['Cat Mobil', 'Panel Bodi', 'Kaca', 'Ban', 'Pelek'];\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"p-6 bg-gray-50 rounded-xl shadow-inner min-h-[60vh]\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      className: \"text-2xl font-extrabold text-indigo-700 mb-6 flex items-center\",\n      children: [/*#__PURE__*/_jsxDEV(ListChecks, {\n        size: 24,\n        className: \"mr-3\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 422,\n        columnNumber: 9\n      }, this), \" 2. Inspeksi Kendaraan\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 421,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mb-6 p-4 bg-indigo-50 border-l-4 border-indigo-400 rounded-lg\",\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"font-semibold text-indigo-800\",\n        children: \"Keterangan Status:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 426,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n        className: \"list-disc list-inside ml-4 text-sm text-indigo-700\",\n        children: [/*#__PURE__*/_jsxDEV(\"li\", {\n          children: \"G = Good (Baik)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 428,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n          children: \"F = Fair (Cukup)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 429,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n          children: \"P = Poor (Buruk)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 430,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 427,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 425,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"space-y-4\",\n      children: inspectionItems.map(item => /*#__PURE__*/_jsxDEV(RatingInput, {\n        inspectionId: item\n        // PERBAIKAN: Memberikan nilai default yang konsisten\n        ,\n        details: formData.inspection[item] || {\n          status: 'G',\n          notes: '',\n          file: null\n        },\n        handleFormChange: handleFormChange\n      }, item, false, {\n        fileName: _jsxFileName,\n        lineNumber: 436,\n        columnNumber: 11\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 434,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex justify-between mt-8\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: goToPrev,\n        type: \"button\",\n        className: \"px-6 py-3 bg-gray-300 text-gray-800 font-bold rounded-xl shadow-md hover:bg-gray-400 transition duration-150\",\n        children: \"\\u2190 Sebelumnya\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 447,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: goToNext,\n        type: \"button\",\n        className: \"px-6 py-3 bg-indigo-600 text-white font-bold rounded-xl shadow-lg hover:bg-indigo-700 transition duration-150\",\n        children: \"Lanjut ke Syarat & Tanda Tangan \\u2192\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 454,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 446,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 420,\n    columnNumber: 5\n  }, this);\n};\n\n// Komponen Utama: Customer dan Vehicle Form\n_c4 = InspectionForm;\nconst CustomerForm = ({\n  formData,\n  handleFormChange,\n  goToNext\n}) => {\n  const handleChange = e => {\n    handleFormChange('customer', e.target.name, e.target.value);\n  };\n\n  // Validasi sederhana untuk memastikan semua bidang Customer terisi\n  const isFormValid = () => {\n    const c = formData.customer;\n    return c.firstName && c.lastName && c.phone && c.carBrand && c.carModel && c.color;\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"p-6 bg-white rounded-xl shadow-lg\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      className: \"text-2xl font-extrabold text-indigo-700 mb-6 flex items-center\",\n      children: [/*#__PURE__*/_jsxDEV(User, {\n        size: 24,\n        className: \"mr-3\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 483,\n        columnNumber: 9\n      }, this), \" 1. Detail Pelanggan & Kendaraan\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 482,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"grid grid-cols-1 md:grid-cols-2 gap-6\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"space-y-4 border-r pr-6\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"text-xl font-semibold text-gray-800 border-b pb-2\",\n          children: \"Detail Pelanggan\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 488,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          name: \"firstName\",\n          placeholder: \"Nama Depan Pelanggan\",\n          value: formData.customer.firstName,\n          onChange: handleChange,\n          required: true,\n          className: \"w-full p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 489,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          name: \"lastName\",\n          placeholder: \"Nama Belakang Pelanggan\",\n          value: formData.customer.lastName,\n          onChange: handleChange,\n          required: true,\n          className: \"w-full p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 497,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          name: \"phone\",\n          type: \"tel\",\n          placeholder: \"Nomor Telepon\",\n          value: formData.customer.phone,\n          onChange: handleChange,\n          required: true,\n          className: \"w-full p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 505,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 487,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"space-y-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"text-xl font-semibold text-gray-800 border-b pb-2\",\n          children: \"Detail Kendaraan\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 518,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          name: \"carBrand\",\n          placeholder: \"Merek Mobil (e.g., Toyota)\",\n          value: formData.customer.carBrand,\n          onChange: handleChange,\n          required: true,\n          className: \"w-full p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 519,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          name: \"carModel\",\n          placeholder: \"Model Mobil (e.g., Camry)\",\n          value: formData.customer.carModel,\n          onChange: handleChange,\n          required: true,\n          className: \"w-full p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 527,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          name: \"color\",\n          placeholder: \"Warna Kendaraan\",\n          value: formData.customer.color,\n          onChange: handleChange,\n          required: true,\n          className: \"w-full p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 535,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 517,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 485,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex justify-end mt-8\",\n      children: /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: goToNext,\n        type: \"button\",\n        disabled: !isFormValid(),\n        className: `px-6 py-3 font-bold rounded-xl shadow-lg transition duration-150 ${isFormValid() ? 'bg-indigo-600 text-white hover:bg-indigo-700' : 'bg-indigo-300 text-white cursor-not-allowed'}`,\n        children: \"Lanjut ke Inspeksi \\u2192\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 547,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 546,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 481,\n    columnNumber: 5\n  }, this);\n};\n\n// Komponen Modal (Popup)\n_c5 = CustomerForm;\nconst Modal = ({\n  title,\n  message,\n  onClose,\n  isSuccess\n}) => /*#__PURE__*/_jsxDEV(\"div\", {\n  className: \"fixed inset-0 bg-gray-600 bg-opacity-75 flex items-center justify-center z-50 p-4\",\n  children: /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"bg-white rounded-xl shadow-2xl p-8 max-w-sm w-full text-center transform transition-all duration-300 scale-100\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: `mx-auto mb-4 ${isSuccess ? 'text-green-500' : 'text-red-500'}`,\n      children: isSuccess ? /*#__PURE__*/_jsxDEV(CheckCircle, {\n        size: 48,\n        className: \"mx-auto\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 570,\n        columnNumber: 22\n      }, this) : /*#__PURE__*/_jsxDEV(X, {\n        size: 48,\n        className: \"mx-auto\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 570,\n        columnNumber: 69\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 569,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n      className: \"text-2xl font-bold mb-3 text-gray-900\",\n      children: title\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 572,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"text-gray-600 mb-6\",\n      children: message\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 573,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: onClose,\n      className: \"w-full py-3 px-4 bg-indigo-600 text-white font-semibold rounded-xl hover:bg-indigo-700 transition duration-150 shadow-md\",\n      children: \"OK\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 574,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 568,\n    columnNumber: 5\n  }, this)\n}, void 0, false, {\n  fileName: _jsxFileName,\n  lineNumber: 567,\n  columnNumber: 3\n}, this);\n\n// --- Komponen Utama Aplikasi ---\n_c6 = Modal;\nconst App = () => {\n  _s4();\n  const [currentPage, setCurrentPage] = useState(1);\n  const [isLoading, setIsLoading] = useState(false);\n  const [modal, setModal] = useState({\n    show: false,\n    title: '',\n    message: '',\n    isSuccess: false\n  });\n  const [dbInstance, setDbInstance] = useState(null);\n  const [userId, setUserId] = useState(null);\n\n  // State data form utama\n  const [formData, setFormData] = useState({\n    customer: {\n      firstName: '',\n      lastName: '',\n      phone: '',\n      carBrand: '',\n      carModel: '',\n      color: ''\n    },\n    inspection: {\n      'Cat Mobil': {\n        status: 'G',\n        notes: '',\n        file: null\n      },\n      'Panel Bodi': {\n        status: 'G',\n        notes: '',\n        file: null\n      },\n      'Kaca': {\n        status: 'G',\n        notes: '',\n        file: null\n      },\n      'Ban': {\n        status: 'G',\n        notes: '',\n        file: null\n      },\n      'Pelek': {\n        status: 'G',\n        notes: '',\n        file: null\n      }\n    },\n    signature: '',\n    agreed: false,\n    date: new Date().toISOString()\n  });\n\n  // --- FIREBASE INIT & AUTH ---\n  useEffect(() => {\n    if (auth && db) {\n      const initializeAuth = async () => {\n        try {\n          if (initialAuthToken) {\n            await signInWithCustomToken(auth, initialAuthToken);\n          } else {\n            await signInAnonymously(auth);\n          }\n        } catch (error) {\n          console.error(\"Firebase auth failed:\", error);\n          // Fallback to anonymous sign-in if custom token fails\n          try {\n            await signInAnonymously(auth);\n          } catch (anonError) {\n            console.error(\"Anonymous sign-in failed:\", anonError);\n          }\n        }\n      };\n      initializeAuth();\n\n      // Listener untuk mendapatkan ID pengguna setelah autentikasi\n      const unsubscribe = auth.onAuthStateChanged(user => {\n        if (user) {\n          setUserId(user.uid);\n          setDbInstance(db);\n          console.log(\"Authenticated with UID:\", user.uid);\n        } else {\n          // Hanya set userId jika auth sudah ready dan tidak ada user (anon)\n          setUserId(crypto.randomUUID());\n          setDbInstance(db);\n        }\n      });\n      return () => unsubscribe();\n    } else {\n      // Jika Firebase tidak terinisialisasi, set ID acak untuk userId\n      setUserId(crypto.randomUUID());\n    }\n  }, []);\n\n  // Handler perubahan form generik\n  const handleFormChange = (section, key, value) => {\n    if (section === 'root') {\n      setFormData(prev => ({\n        ...prev,\n        [key]: value\n      }));\n    } else if (section === 'inspection') {\n      // Untuk inspection, 'key' adalah nama item, dan 'value' adalah objek detail {status, notes, file}\n      setFormData(prev => ({\n        ...prev,\n        inspection: {\n          ...prev.inspection,\n          [key]: value\n        }\n      }));\n    } else {\n      // Untuk customer\n      setFormData(prev => ({\n        ...prev,\n        [section]: {\n          ...prev[section],\n          [key]: value\n        }\n      }));\n    }\n  };\n  const goToNextPage = () => setCurrentPage(prev => prev + 1);\n  const goToPrevPage = () => setCurrentPage(prev => prev - 1);\n  const closeModal = () => setModal({\n    show: false,\n    title: '',\n    message: '',\n    isSuccess: false\n  });\n\n  // Handler Submit\n  const handleSubmit = async e => {\n    e.preventDefault();\n    if (!formData.agreed) {\n      setModal({\n        show: true,\n        title: 'Error',\n        message: 'Anda harus menyetujui Syarat & Ketentuan.',\n        isSuccess: false\n      });\n      return;\n    }\n    if (!formData.signature) {\n      setModal({\n        show: true,\n        title: 'Error',\n        message: 'Tanda tangan pelanggan tidak boleh kosong.',\n        isSuccess: false\n      });\n      return;\n    }\n    if (isLoading || !userId) return;\n    setIsLoading(true);\n    let firestoreSuccess = true;\n    try {\n      // 1. Filter Data URL Gambar yang valid dan hapus input file mentah\n      const dataToSend = JSON.parse(JSON.stringify(formData));\n\n      // Hapus Data URL yang besar jika tidak ada, atau saring hanya yang dibutuhkan\n      Object.keys(dataToSend.inspection).forEach(item => {\n        if (dataToSend.inspection[item].file) {\n          // Pastikan hanya mengirim name dan dataUrl\n          dataToSend.inspection[item].file = {\n            name: dataToSend.inspection[item].file.name,\n            dataUrl: dataToSend.inspection[item].file.dataUrl\n          };\n        }\n      });\n\n      // 2. Simpan ke Firestore (hanya jika dbInstance ada)\n      if (dbInstance) {\n        try {\n          const inspectionCollectionRef = collection(dbInstance, getCollectionPath(userId, 'inspections'));\n          await addDoc(inspectionCollectionRef, dataToSend);\n          console.log(\"Data berhasil disimpan ke Firestore.\");\n        } catch (error) {\n          console.error(\"Gagal menyimpan data ke Firestore:\", error);\n          firestoreSuccess = false;\n        }\n      } else {\n        console.warn(\"Firebase Firestore tidak terinisialisasi. Data tidak disimpan.\");\n        firestoreSuccess = false;\n      }\n\n      // 3. Panggil backend untuk membuat dan mengunduh PDF (selalu coba panggil)\n      await fetchPdf(dataToSend);\n\n      // Tampilkan modal sukses\n      const successMessage = firestoreSuccess ? 'Inspeksi berhasil ditambahkan dan PDF akan diunduh.' : 'Inspeksi berhasil diunduh. (Penyimpanan ke database gagal).';\n      setModal({\n        show: true,\n        title: 'Success',\n        message: successMessage,\n        isSuccess: true\n      });\n\n      // Reset form setelah berhasil\n      setFormData({\n        customer: {\n          firstName: '',\n          lastName: '',\n          phone: '',\n          carBrand: '',\n          carModel: '',\n          color: ''\n        },\n        inspection: {\n          'Cat Mobil': {\n            status: 'G',\n            notes: '',\n            file: null\n          },\n          'Panel Bodi': {\n            status: 'G',\n            notes: '',\n            file: null\n          },\n          'Kaca': {\n            status: 'G',\n            notes: '',\n            file: null\n          },\n          'Ban': {\n            status: 'G',\n            notes: '',\n            file: null\n          },\n          'Pelek': {\n            status: 'G',\n            notes: '',\n            file: null\n          }\n        },\n        signature: '',\n        agreed: false,\n        date: new Date().toISOString()\n      });\n      setCurrentPage(1);\n    } catch (error) {\n      // Catch error dari fetchPdf (hanya jika semua retry gagal)\n      console.error(\"Submission failed:\", error);\n      setModal({\n        show: true,\n        title: 'Error',\n        message: 'Gagal memproses inspeksi. (Gagal unduh PDF atau masalah database). Silakan coba lagi.',\n        isSuccess: false\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n  const fetchPdf = async data => {\n    // Implementasi logic unduh PDF dari backend\n    console.log(\"Mencoba fetch PDF dari backend...\");\n    const apiUrl = `/api/generate-pdf`;\n    let attempt = 0;\n    const maxRetries = 3;\n    const baseDelay = 1000;\n\n    // Fungsi delay\n    const delay = ms => new Promise(resolve => setTimeout(resolve, ms));\n    while (attempt < maxRetries) {\n      try {\n        const response = await fetch(apiUrl, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify(data)\n        });\n        if (!response.ok) {\n          const errorText = await response.text();\n          throw new Error(`HTTP error! status: ${response.status}. Details: ${errorText}`);\n        }\n\n        // Ambil nama file dari header Content-Disposition (jika ada)\n        const contentDisposition = response.headers.get('Content-Disposition');\n        let filename = 'inspection_report.pdf';\n        if (contentDisposition) {\n          const match = contentDisposition.match(/filename=\"(.+)\"/);\n          if (match && match[1]) {\n            filename = match[1];\n          }\n        }\n        const blob = await response.blob();\n        const url = window.URL.createObjectURL(blob);\n        const a = document.createElement('a');\n        a.href = url;\n        a.download = filename;\n        document.body.appendChild(a);\n        a.click();\n        a.remove();\n        window.URL.revokeObjectURL(url);\n        console.log(\"PDF berhasil diunduh.\");\n        return; // Keluar dari loop jika berhasil\n      } catch (error) {\n        console.error(`Attempt ${attempt + 1} failed:`, error);\n        attempt++;\n        if (attempt < maxRetries) {\n          const delayTime = baseDelay * Math.pow(2, attempt - 1); // Exponential backoff\n          await delay(delayTime);\n        } else {\n          // Tampilkan pesan error kepada pengguna jika semua retry gagal\n          throw new Error(\"PDF download failed after retries. Check Node.js backend server.\");\n        }\n      }\n    }\n  };\n\n  // --- Render Halaman ---\n  const renderPage = () => {\n    switch (currentPage) {\n      case 1:\n        return /*#__PURE__*/_jsxDEV(CustomerForm, {\n          formData: formData,\n          handleFormChange: handleFormChange,\n          goToNext: goToNextPage\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 832,\n          columnNumber: 16\n        }, this);\n      case 2:\n        return /*#__PURE__*/_jsxDEV(InspectionForm, {\n          formData: formData,\n          handleFormChange: handleFormChange,\n          goToNext: goToNextPage,\n          goToPrev: goToPrevPage\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 834,\n          columnNumber: 16\n        }, this);\n      case 3:\n        return /*#__PURE__*/_jsxDEV(\"form\", {\n          onSubmit: handleSubmit,\n          className: \"p-6 bg-white rounded-xl shadow-lg\",\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            className: \"text-2xl font-extrabold text-indigo-700 mb-6 flex items-center\",\n            children: [/*#__PURE__*/_jsxDEV(FileText, {\n              size: 24,\n              className: \"mr-3\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 839,\n              columnNumber: 15\n            }, this), \" 3. Syarat & Ketentuan & Tanda Tangan\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 838,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"bg-gray-100 p-4 rounded-lg h-64 overflow-y-scroll border border-gray-200 text-sm text-gray-700 space-y-2 mb-6\",\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"font-bold text-center mb-3\",\n              children: \"SYARAT DAN KETENTUAN - SERAH TERIMA KENDARAAN DI WRAP STATION\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 844,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"ol\", {\n              className: \"list-decimal list-inside space-y-1\",\n              children: [/*#__PURE__*/_jsxDEV(\"li\", {\n                children: \"Kondisi kendaraan dapat berubah setelah pembersihan. Tim akan menginformasikan jika ada perubahan.\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 846,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n                children: \"Status cat kendaraan (repaint/original) tidak dapat dipastikan, risiko ditanggung pemilik.\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 847,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n                children: \"Penambahan jarak tempuh (mileage) bisa terjadi, dan bukan tanggung jawab Wrap Station.\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 848,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n                children: \"Kerusakan/malfungsi mesin selama atau setelah pengerjaan bukan tanggung jawab Wrap Station.\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 849,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n                children: \"Kerusakan akibat pembongkaran aksesori oleh pemilik selama atau setelah pengerjaan bukan tanggung jawab Wrap Station.\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 850,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n                children: \"Kehilangan barang pribadi bukan tanggung jawab Wrap Station.\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 851,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n                children: \"Wrap Station berhak melakukan tindakan teknis yang diperlukan tanpa persetujuan lebih lanjut.\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 852,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n                children: \"Kondisi/modifikasi khusus yang tidak diinformasikan di awal dapat membatalkan garansi.\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 853,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n                children: \"Penurunan baterai EV adalah kondisi alami, bukan tanggung jawab kami.\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 854,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n                children: \"Estimasi pengerjaan dapat berubah karena faktor tak terduga.\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 855,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 845,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 843,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(SignatureForm, {\n            formData: formData,\n            handleFormChange: handleFormChange,\n            onSubmit: handleSubmit,\n            isLoading: isLoading\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 859,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex justify-between mt-8\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: goToPrevPage,\n              type: \"button\",\n              className: \"px-6 py-3 bg-gray-300 text-gray-800 font-bold rounded-xl shadow-md hover:bg-gray-400 transition duration-150\",\n              children: \"\\u2190 Sebelumnya\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 867,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"submit\"\n              // Hanya disable jika belum setuju ATAU belum ada tanda tangan\n              ,\n              disabled: isLoading || !formData.agreed || !formData.signature,\n              className: `px-8 py-3 font-bold rounded-xl shadow-lg transition duration-150 flex items-center justify-center ${isLoading || !formData.agreed || !formData.signature ? 'bg-indigo-300 cursor-not-allowed text-gray-100' // Tambahkan text-gray-100 untuk visibilitas\n              : 'bg-indigo-600 text-white hover:bg-indigo-700'}`,\n              children: isLoading ? /*#__PURE__*/_jsxDEV(_Fragment, {\n                children: [/*#__PURE__*/_jsxDEV(Car, {\n                  size: 20,\n                  className: \"animate-pulse mr-2\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 886,\n                  columnNumber: 21\n                }, this), \" Membuat PDF...\"]\n              }, void 0, true) : 'Submit Inspection & Download PDF'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 874,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 866,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 837,\n          columnNumber: 11\n        }, this);\n      default:\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          children: \"Halaman Tidak Ditemukan\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 896,\n          columnNumber: 16\n        }, this);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"min-h-screen bg-gray-100 p-4 sm:p-8 font-sans\",\n    children: [/*#__PURE__*/_jsxDEV(\"header\", {\n      className: \"mb-8 p-4 bg-white rounded-xl shadow-md\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        className: \"text-2xl sm:text-3xl font-extrabold text-indigo-800 flex items-center\",\n        children: [/*#__PURE__*/_jsxDEV(Car, {\n          size: 32,\n          className: \"mr-3\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 904,\n          columnNumber: 11\n        }, this), \" Wrap Station - Form Inspeksi Kendaraan\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 903,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mt-2 text-sm text-gray-500\",\n        children: [\"User ID: \", userId || 'Authenticating...']\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 906,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 902,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"main\", {\n      className: \"max-w-4xl mx-auto\",\n      children: renderPage()\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 911,\n      columnNumber: 7\n    }, this), modal.show && /*#__PURE__*/_jsxDEV(Modal, {\n      ...modal,\n      onClose: closeModal\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 915,\n      columnNumber: 22\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 901,\n    columnNumber: 5\n  }, this);\n};\n_s4(App, \"jEwTJZ0+WChX2+87XLyEFB0q1nY=\");\n_c7 = App;\nexport default App;\nvar _c, _c2, _c3, _c4, _c5, _c6, _c7;\n$RefreshReg$(_c, \"ImageInput\");\n$RefreshReg$(_c2, \"RatingInput\");\n$RefreshReg$(_c3, \"SignatureForm\");\n$RefreshReg$(_c4, \"InspectionForm\");\n$RefreshReg$(_c5, \"CustomerForm\");\n$RefreshReg$(_c6, \"Modal\");\n$RefreshReg$(_c7, \"App\");","map":{"version":3,"names":["React","useState","useCallback","useEffect","useRef","getAuth","signInAnonymously","signInWithCustomToken","initializeApp","getFirestore","collection","doc","setDoc","query","onSnapshot","orderBy","where","addDoc","X","CheckCircle","Car","DollarSign","ListChecks","FileText","User","jsxDEV","_jsxDEV","Fragment","_Fragment","appId","__app_id","firebaseConfig","__firebase_config","JSON","parse","e","console","error","initialAuthToken","__initial_auth_token","app","db","auth","Object","keys","length","getCollectionPath","userId","collectionName","ImageInput","inspectionId","file","handleFormChange","_s","fileInputRef","handleFileChange","fileObj","target","files","reader","FileReader","onloadend","existingDetails","status","notes","name","dataUrl","result","readAsDataURL","handleRemoveImage","current","value","className","children","type","accept","onChange","ref","fileName","_jsxFileName","lineNumber","columnNumber","onClick","size","_c","RatingInput","details","_s2","showNote","setShowNote","setRating","rating","setNote","toggleNote","prev","statusColors","G","F","P","statusDescriptions","map","placeholder","rows","_c2","SignatureForm","formData","onSubmit","isLoading","_s3","canvasRef","isDrawing","setIsDrawing","hasDrawn","setHasDrawn","signature","clearCanvas","ctx","canvas","clearRect","width","height","fillStyle","fillRect","redrawSignatureFromState","signatureDataUrl","getContext","img","Image","onload","drawImage","src","rect","getBoundingClientRect","drawSignature","isTouch","x","touches","clientX","left","y","clientY","top","lineWidth","lineCap","strokeStyle","lineTo","stroke","beginPath","moveTo","handleStart","preventDefault","handleEnd","toDataURL","blankCanvasDataUrl","replace","clearSignature","mouseMoveHandler","touchMoveHandler","mouseDownHandler","touchStartHandler","mouseUpHandler","touchEndHandler","addEventListener","document","passive","removeEventListener","style","touchAction","title","id","checked","agreed","htmlFor","_c3","InspectionForm","goToNext","goToPrev","inspectionItems","item","inspection","_c4","CustomerForm","handleChange","isFormValid","c","customer","firstName","lastName","phone","carBrand","carModel","color","required","disabled","_c5","Modal","message","onClose","isSuccess","_c6","App","_s4","currentPage","setCurrentPage","setIsLoading","modal","setModal","show","dbInstance","setDbInstance","setUserId","setFormData","date","Date","toISOString","initializeAuth","anonError","unsubscribe","onAuthStateChanged","user","uid","log","crypto","randomUUID","section","key","goToNextPage","goToPrevPage","closeModal","handleSubmit","firestoreSuccess","dataToSend","stringify","forEach","inspectionCollectionRef","warn","fetchPdf","successMessage","data","apiUrl","attempt","maxRetries","baseDelay","delay","ms","Promise","resolve","setTimeout","response","fetch","method","headers","body","ok","errorText","text","Error","contentDisposition","get","filename","match","blob","url","window","URL","createObjectURL","a","createElement","href","download","appendChild","click","remove","revokeObjectURL","delayTime","Math","pow","renderPage","_c7","$RefreshReg$"],"sources":["/home/ayu/Documents/project-ayu/app-wrap-station/src/dashboard.jsx"],"sourcesContent":["import React, { useState, useCallback, useEffect, useRef } from 'react';\n// PERBAIKAN: Mengganti impor untuk versi modular\nimport { getAuth, signInAnonymously, signInWithCustomToken } from 'firebase/auth';\nimport { initializeApp } from 'firebase/app';\nimport { getFirestore, collection, doc, setDoc, query, onSnapshot, orderBy, where, addDoc } from 'firebase/firestore';\nimport { X, CheckCircle, Car, DollarSign, ListChecks, FileText, User } from 'lucide-react';\n\n// --- KONFIGURASI FIREBASE ---\nconst appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';\n\n// Perbaikan: Amankan proses JSON.parse dengan pengecekan tambahan\nlet firebaseConfig = {};\ntry {\n  // Hanya parse jika variabel didefinisikan dan bukan string kosong\n  if (typeof __firebase_config !== 'undefined' && __firebase_config) {\n      firebaseConfig = JSON.parse(__firebase_config);\n  }\n} catch (e) {\n  console.error(\"Gagal mem-parsing Firebase config:\", e);\n}\n\nconst initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;\n\nlet app;\nlet db;\nlet auth;\n\ntry {\n  if (Object.keys(firebaseConfig).length > 0) {\n    // Memastikan initializeApp hanya dipanggil sekali\n    if (!app) {\n        app = initializeApp(firebaseConfig);\n        db = getFirestore(app);\n        auth = getAuth(app);\n    }\n  } else {\n    console.error(\"Firebase config is missing or invalid. App will not use Firestore.\");\n  }\n} catch (error) {\n  console.error(\"Failed to initialize Firebase:\", error);\n}\n\n// Fungsi untuk mendapatkan path koleksi Firestore\nconst getCollectionPath = (userId, collectionName) => {\n// Kita simpan data inspeksi secara private per user\nreturn `/artifacts/${appId}/users/${userId}/${collectionName}`;\n};\n\n// --- Komponen Pembantu ---\n\nconst ImageInput = ({ inspectionId, file, handleFormChange }) => {\n  const fileInputRef = useRef(null);\n\n  const handleFileChange = (e) => {\n    const fileObj = e.target.files[0];\n    if (fileObj) {\n      const reader = new FileReader();\n      reader.onloadend = () => {\n        // PERBAIKAN: Pastikan untuk mempertahankan status dan notes saat file baru diunggah\n        const existingDetails = file ? { status: file.status || 'G', notes: file.notes || '' } : { status: 'G', notes: '' };\n        \n        handleFormChange('inspection', inspectionId, {\n          ...existingDetails,\n          file: {\n            name: fileObj.name,\n            dataUrl: reader.result, // Data URL (Base64) untuk dikirim ke backend\n          },\n        });\n      };\n      reader.readAsDataURL(fileObj);\n    }\n  };\n\n  const handleRemoveImage = () => {\n    // PERBAIKAN: Pertahankan status dan notes saat menghapus file\n    const existingDetails = file ? { status: file.status || 'G', notes: file.notes || '' } : { status: 'G', notes: '' };\n    handleFormChange('inspection', inspectionId, { \n      ...existingDetails,\n      file: null \n    });\n    if (fileInputRef.current) {\n        fileInputRef.current.value = \"\"; // Reset input file\n    }\n  };\n\n  return (\n    <div className=\"flex flex-col items-start space-y-2 mt-2\">\n      <input \n        type=\"file\" \n        accept=\"image/*\" \n        onChange={handleFileChange} \n        ref={fileInputRef}\n        className=\"text-sm text-gray-700 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100\"\n      />\n      {file && file.dataUrl && (\n        <div className=\"flex items-center space-x-3 p-2 bg-gray-50 rounded-lg max-w-full\">\n          <span className=\"text-xs font-medium text-gray-600 truncate max-w-xs\">{file.name || 'Image Uploaded'}</span>\n          <button \n            type=\"button\" \n            onClick={handleRemoveImage} \n            className=\"text-red-500 hover:text-red-700 transition duration-150\"\n          >\n            <X size={16} />\n          </button>\n        </div>\n      )}\n    </div>\n  );\n};\n\n// KOMPONEN INI YANG DIPERBAIKI\nconst RatingInput = ({ inspectionId, details, handleFormChange }) => {\n  // PERBAIKAN: Gunakan state untuk mengontrol visibilitas note secara lokal\n  // Tetapi inisialisasikan dari notes yang sudah ada (jika ada)\n  const [showNote, setShowNote] = useState(details.notes || details.file);\n\n  // Perbaikan: Pastikan inspectionId digunakan untuk mengubah state\n  const setRating = (rating) => {\n    handleFormChange('inspection', inspectionId, { ...details, status: rating });\n  };\n\n  // Perbaikan: Pastikan inspectionId digunakan untuk mengubah state\n  const setNote = (e) => {\n    handleFormChange('inspection', inspectionId, { ...details, notes: e.target.value });\n  };\n  \n  const toggleNote = () => {\n    setShowNote(prev => !prev);\n  };\n\n  const statusColors = {\n    G: 'bg-green-500 hover:bg-green-600',\n    F: 'bg-yellow-500 hover:bg-yellow-600',\n    P: 'bg-red-500 hover:bg-red-600',\n  };\n  \n  // Menampilkan deskripsi status\n  const statusDescriptions = {\n      G: 'Baik (Good)',\n      F: 'Cukup (Fair)',\n      P: 'Buruk (Poor)',\n  };\n\n  return (\n    <div className=\"p-4 border border-gray-200 rounded-xl mb-4 bg-white shadow-sm\">\n      <div className=\"flex flex-col sm:flex-row justify-between items-start sm:items-center\">\n        <div className=\"flex items-center space-x-3 mb-3 sm:mb-0\">\n          <span className=\"text-lg font-bold text-gray-800 flex-shrink-0\">{inspectionId}</span> \n          <span className=\"text-sm text-gray-500\">({statusDescriptions[details.status]})</span>\n        </div>\n\n        <div className=\"flex items-center space-x-3\">\n          {['G', 'F', 'P'].map((rating) => (\n            <button\n              key={rating}\n              type=\"button\"\n              onClick={() => setRating(rating)}\n              className={`w-10 h-10 rounded-full font-bold text-white transition duration-200 ${\n                details.status === rating ? statusColors[rating] : 'bg-gray-300 hover:bg-gray-400'\n              }`}\n            >\n              {rating}\n            </button>\n          ))}\n          \n          <button\n            type=\"button\"\n            onClick={toggleNote}\n            className=\"px-4 py-2 bg-indigo-500 text-white text-sm font-medium rounded-full hover:bg-indigo-600 transition duration-150 shadow-md flex-shrink-0\"\n          >\n            {showNote ? 'Sembunyikan Catatan' : 'Tambah Catatan/Foto'}\n          </button>\n        </div>\n      </div>\n\n      {showNote && (\n        <div className=\"mt-4 p-3 bg-indigo-50 rounded-lg\">\n          <textarea\n            value={details.notes}\n            onChange={setNote}\n            placeholder={`Tambahkan catatan untuk ${inspectionId}...`}\n            rows=\"3\"\n            className=\"w-full p-2 border border-indigo-200 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 text-gray-700\"\n          ></textarea>\n          <ImageInput\n            inspectionId={inspectionId}\n            file={details.file}\n            handleFormChange={handleFormChange}\n          />\n        </div>\n      )}\n    </div>\n  );\n};\n\n\n// Komponen untuk Tanda Tangan\nconst SignatureForm = ({ formData, handleFormChange, onSubmit, isLoading }) => {\n  const canvasRef = useRef(null);\n  const [isDrawing, setIsDrawing] = useState(false); \n  // PERBAIKAN: Gunakan hasDrawn untuk mengontrol visibilitas tombol hapus\n  const [hasDrawn, setHasDrawn] = useState(!!formData.signature); \n\n  // Fungsi untuk membersihkan canvas dan mengisi dengan warna putih\n  const clearCanvas = (ctx, canvas) => {\n    ctx.clearRect(0, 0, canvas.width, canvas.height); \n    ctx.fillStyle = '#ffffff'; \n    ctx.fillRect(0, 0, canvas.width, canvas.height);\n  };\n  \n  // Fungsi yang memuat gambar tanda tangan dari state ke canvas\n  const redrawSignatureFromState = useCallback((signatureDataUrl) => {\n    const canvas = canvasRef.current;\n    if (!canvas || !signatureDataUrl) return;\n\n    const ctx = canvas.getContext('2d');\n    \n    // 1. Bersihkan canvas\n    clearCanvas(ctx, canvas);\n\n    // 2. Gambar ulang tanda tangan\n    const img = new Image();\n    img.onload = () => {\n      // Pastikan gambar digambar pada ukuran canvas saat ini\n      ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\n    };\n    img.src = signatureDataUrl;\n    \n    setHasDrawn(true);\n\n  }, []);\n  \n  // Efek untuk Inisialisasi Canvas dan Redraw\n  useEffect(() => {\n    const canvas = canvasRef.current;\n    if (!canvas) return;\n\n    // Set canvas resolution based on display size for clear rendering\n    const rect = canvas.getBoundingClientRect();\n    canvas.width = rect.width;\n    canvas.height = rect.height;\n    \n    const ctx = canvas.getContext('2d');\n    \n    // Inisialisasi dengan latar belakang putih\n    clearCanvas(ctx, canvas); \n    \n    // Redraw tanda tangan dari state jika ada\n    if (formData.signature) {\n        redrawSignatureFromState(formData.signature);\n    }\n  }, [formData.signature, redrawSignatureFromState]); // Hapus isDrawing dari dependencies, agar tidak redraw saat menggambar\n\n  // Menggambar saat mouse/sentuhan bergerak\n  const drawSignature = useCallback((e, isTouch = false) => {\n    if (!isDrawing) return; \n    \n    const canvas = canvasRef.current;\n    if (!canvas) return;\n    const ctx = canvas.getContext('2d');\n    \n    const rect = canvas.getBoundingClientRect();\n    const x = isTouch ? e.touches[0].clientX - rect.left : e.clientX - rect.left;\n    const y = isTouch ? e.touches[0].clientY - rect.top : e.clientY - rect.top;\n\n    ctx.lineWidth = 2;\n    ctx.lineCap = 'round';\n    ctx.strokeStyle = '#000000';\n    ctx.lineTo(x, y);\n    ctx.stroke();\n    ctx.beginPath();\n    ctx.moveTo(x, y);\n    \n    // Perbarui hasDrawn setelah menggambar\n    setHasDrawn(true);\n    \n  }, [isDrawing]); \n\n  // Memulai menggambar\n  const handleStart = useCallback((e, isTouch) => {\n    if (isTouch) e.preventDefault(); \n\n    setIsDrawing(true);\n    const canvas = canvasRef.current;\n    if (!canvas) return;\n    const ctx = canvas.getContext('2d');\n    \n    const rect = canvas.getBoundingClientRect();\n    const x = isTouch ? e.touches[0].clientX - rect.left : e.clientX - rect.left;\n    const y = isTouch ? e.touches[0].clientY - rect.top : e.clientY - rect.top;\n    \n    // Mulai path baru\n    ctx.beginPath();\n    ctx.moveTo(x, y);\n    \n  }, []);\n\n  // Mengakhiri menggambar dan menyimpan ke state\n  const handleEnd = useCallback(() => {\n    if (isDrawing) { \n      setIsDrawing(false);\n      const canvas = canvasRef.current;\n      if (canvas) {\n        // Simpan tanda tangan yang baru digambar sebagai Data URL\n        const dataUrl = canvas.toDataURL('image/png');\n        // PERBAIKAN: Hanya simpan jika ada gambar yang benar-benar ditarik (lebih dari sekadar latar belakang putih)\n        const blankCanvasDataUrl = canvas.toDataURL('image/png').replace(/^data:image\\/png;base64,/, '');\n\n        // Tanda tangan dianggap valid jika dataUrl berbeda secara signifikan dari canvas kosong\n        // Ini adalah pengecekan sederhana, dataUrl kanvas kosong yang baru dibersihkan biasanya sangat pendek.\n        // Jika dataUrl lebih dari panjang tertentu, kita anggap itu tanda tangan\n        if (dataUrl.length > 5000) { \n            handleFormChange('root', 'signature', dataUrl);\n        } else {\n             handleFormChange('root', 'signature', ''); // Jika hanya kanvas kosong\n             setHasDrawn(false);\n        }\n      }\n    }\n  }, [isDrawing, handleFormChange]); \n\n  const clearSignature = () => {\n    const canvas = canvasRef.current;\n    if (canvas) {\n      const ctx = canvas.getContext('2d');\n      clearCanvas(ctx, canvas); // Bersihkan tampilan canvas\n      handleFormChange('root', 'signature', ''); // Kosongkan state\n      setHasDrawn(false);\n    }\n  };\n\n  // Efek untuk mengatur Event Listeners (hanya sekali saat mount)\n  useEffect(() => {\n    const canvas = canvasRef.current;\n    if (!canvas) return;\n\n    const mouseMoveHandler = (e) => drawSignature(e, false);\n    const touchMoveHandler = (e) => drawSignature(e, true);\n    const mouseDownHandler = (e) => handleStart(e, false);\n    const touchStartHandler = (e) => handleStart(e, true);\n    \n    const mouseUpHandler = () => handleEnd();\n    const touchEndHandler = () => handleEnd();\n\n\n    // Pasang Event Listeners\n    canvas.addEventListener('mousedown', mouseDownHandler);\n    canvas.addEventListener('mousemove', mouseMoveHandler);\n    // document untuk menangkap mouseup di luar canvas\n    document.addEventListener('mouseup', mouseUpHandler); \n    \n    canvas.addEventListener('touchstart', touchStartHandler, { passive: false }); // Gunakan passive: false untuk preventDefault di handleStart\n    canvas.addEventListener('touchmove', touchMoveHandler, { passive: false });\n    // document untuk menangkap touchend di luar canvas\n    document.addEventListener('touchend', touchEndHandler); \n\n    // Cleanup event listeners\n    return () => {\n      canvas.removeEventListener('mousedown', mouseDownHandler);\n      canvas.removeEventListener('mousemove', mouseMoveHandler);\n      document.removeEventListener('mouseup', mouseUpHandler); \n      \n      canvas.removeEventListener('touchstart', touchStartHandler);\n      canvas.removeEventListener('touchmove', touchMoveHandler);\n      document.removeEventListener('touchend', touchEndHandler); \n    };\n  }, [drawSignature, handleStart, handleEnd]); // dependencies ini harus tetap ada\n  \n  return (\n    <div className=\"p-6 bg-white rounded-xl shadow-lg mt-6\">\n      <h3 className=\"text-xl font-bold text-gray-800 mb-4\">Tanda Tangan Pelanggan</h3>\n      <div className=\"relative border border-gray-300 rounded-lg overflow-hidden\">\n        <canvas\n          ref={canvasRef}\n          className=\"w-full h-48 bg-white cursor-crosshair\"\n          style={{ touchAction: 'none' }} // Mencegah scrolling browser saat menggambar\n        ></canvas>\n        <button \n          type=\"button\"\n          onClick={clearSignature}\n          // PERBAIKAN: Kontrol visibilitas tombol hapus menggunakan state hasDrawn\n          className={`absolute top-2 right-2 p-2 rounded-full transition duration-150 ${\n             hasDrawn ? 'bg-red-100 text-red-600 hover:bg-red-200 opacity-100' : 'opacity-0 pointer-events-none'\n          }`}\n          title=\"Hapus Tanda Tangan\"\n        >\n          <X size={20} />\n        </button>\n      </div>\n\n      <div className=\"mt-4 flex items-start\"> {/* Menggunakan items-start untuk align label/checkbox */}\n        <input \n          type=\"checkbox\" \n          id=\"agreeTerms\" \n          checked={formData.agreed} \n          onChange={(e) => handleFormChange('root', 'agreed', e.target.checked)}\n          className=\"h-5 w-5 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500 flex-shrink-0 mt-1\"\n        />\n        <label htmlFor=\"agreeTerms\" className=\"ml-3 text-base text-gray-700 font-medium\">\n          Saya telah membaca dan menyetujui Syarat & Ketentuan.\n        </label>\n      </div>\n    </div>\n  );\n};\n\n\n// Komponen Utama: Form Inspeksi\nconst InspectionForm = ({ formData, handleFormChange, goToNext, goToPrev }) => {\n  // Hanya mendefinisikan item-item inspeksi\n  const inspectionItems = [\n    'Cat Mobil',\n    'Panel Bodi',\n    'Kaca',\n    'Ban',\n    'Pelek',\n  ];\n\n  return (\n    <div className=\"p-6 bg-gray-50 rounded-xl shadow-inner min-h-[60vh]\">\n      <h2 className=\"text-2xl font-extrabold text-indigo-700 mb-6 flex items-center\">\n        <ListChecks size={24} className=\"mr-3\"/> 2. Inspeksi Kendaraan\n      </h2>\n      \n      <div className=\"mb-6 p-4 bg-indigo-50 border-l-4 border-indigo-400 rounded-lg\">\n        <p className=\"font-semibold text-indigo-800\">Keterangan Status:</p>\n        <ul className=\"list-disc list-inside ml-4 text-sm text-indigo-700\">\n          <li>G = Good (Baik)</li>\n          <li>F = Fair (Cukup)</li>\n          <li>P = Poor (Buruk)</li>\n        </ul>\n      </div>\n\n      <div className=\"space-y-4\">\n        {inspectionItems.map((item) => (\n          <RatingInput\n            key={item}\n            inspectionId={item} \n            // PERBAIKAN: Memberikan nilai default yang konsisten\n            details={formData.inspection[item] || { status: 'G', notes: '', file: null }}\n            handleFormChange={handleFormChange}\n          />\n        ))}\n      </div>\n\n      <div className=\"flex justify-between mt-8\">\n        <button\n          onClick={goToPrev}\n          type=\"button\"\n          className=\"px-6 py-3 bg-gray-300 text-gray-800 font-bold rounded-xl shadow-md hover:bg-gray-400 transition duration-150\"\n        >\n          &larr; Sebelumnya\n        </button>\n        <button\n          onClick={goToNext}\n          type=\"button\"\n          className=\"px-6 py-3 bg-indigo-600 text-white font-bold rounded-xl shadow-lg hover:bg-indigo-700 transition duration-150\"\n        >\n          Lanjut ke Syarat & Tanda Tangan &rarr;\n        </button>\n      </div>\n    </div>\n  );\n};\n\n\n// Komponen Utama: Customer dan Vehicle Form\nconst CustomerForm = ({ formData, handleFormChange, goToNext }) => {\n  const handleChange = (e) => {\n    handleFormChange('customer', e.target.name, e.target.value);\n  };\n  \n  // Validasi sederhana untuk memastikan semua bidang Customer terisi\n  const isFormValid = () => {\n    const c = formData.customer;\n    return c.firstName && c.lastName && c.phone && c.carBrand && c.carModel && c.color;\n  };\n\n\n  return (\n    <div className=\"p-6 bg-white rounded-xl shadow-lg\">\n      <h2 className=\"text-2xl font-extrabold text-indigo-700 mb-6 flex items-center\">\n        <User size={24} className=\"mr-3\"/> 1. Detail Pelanggan & Kendaraan\n      </h2>\n      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n        {/* Customer Details */}\n        <div className=\"space-y-4 border-r pr-6\">\n          <h3 className=\"text-xl font-semibold text-gray-800 border-b pb-2\">Detail Pelanggan</h3>\n          <input\n            name=\"firstName\"\n            placeholder=\"Nama Depan Pelanggan\"\n            value={formData.customer.firstName}\n            onChange={handleChange}\n            required\n            className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500\"\n          />\n          <input\n            name=\"lastName\"\n            placeholder=\"Nama Belakang Pelanggan\"\n            value={formData.customer.lastName}\n            onChange={handleChange}\n            required\n            className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500\"\n          />\n          <input\n            name=\"phone\"\n            type=\"tel\"\n            placeholder=\"Nomor Telepon\"\n            value={formData.customer.phone}\n            onChange={handleChange}\n            required\n            className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500\"\n          />\n        </div>\n\n        {/* Vehicle Details */}\n        <div className=\"space-y-4\">\n          <h3 className=\"text-xl font-semibold text-gray-800 border-b pb-2\">Detail Kendaraan</h3>\n          <input\n            name=\"carBrand\"\n            placeholder=\"Merek Mobil (e.g., Toyota)\"\n            value={formData.customer.carBrand}\n            onChange={handleChange}\n            required\n            className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500\"\n          />\n          <input\n            name=\"carModel\"\n            placeholder=\"Model Mobil (e.g., Camry)\"\n            value={formData.customer.carModel}\n            onChange={handleChange}\n            required\n            className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500\"\n          />\n          <input\n            name=\"color\"\n            placeholder=\"Warna Kendaraan\"\n            value={formData.customer.color}\n            onChange={handleChange}\n            required\n            className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500\"\n          />\n        </div>\n      </div>\n\n      <div className=\"flex justify-end mt-8\">\n        <button\n          onClick={goToNext}\n          type=\"button\"\n          disabled={!isFormValid()}\n          className={`px-6 py-3 font-bold rounded-xl shadow-lg transition duration-150 ${\n            isFormValid() \n              ? 'bg-indigo-600 text-white hover:bg-indigo-700' \n              : 'bg-indigo-300 text-white cursor-not-allowed'\n          }`}\n        >\n          Lanjut ke Inspeksi &rarr;\n        </button>\n      </div>\n    </div>\n  );\n};\n\n\n// Komponen Modal (Popup)\nconst Modal = ({ title, message, onClose, isSuccess }) => (\n  <div className=\"fixed inset-0 bg-gray-600 bg-opacity-75 flex items-center justify-center z-50 p-4\">\n    <div className=\"bg-white rounded-xl shadow-2xl p-8 max-w-sm w-full text-center transform transition-all duration-300 scale-100\">\n      <div className={`mx-auto mb-4 ${isSuccess ? 'text-green-500' : 'text-red-500'}`}>\n        {isSuccess ? <CheckCircle size={48} className=\"mx-auto\"/> : <X size={48} className=\"mx-auto\"/>}\n      </div>\n      <h3 className=\"text-2xl font-bold mb-3 text-gray-900\">{title}</h3>\n      <p className=\"text-gray-600 mb-6\">{message}</p>\n      <button\n        onClick={onClose}\n        className=\"w-full py-3 px-4 bg-indigo-600 text-white font-semibold rounded-xl hover:bg-indigo-700 transition duration-150 shadow-md\"\n      >\n        OK\n      </button>\n    </div>\n  </div>\n);\n\n// --- Komponen Utama Aplikasi ---\nconst App = () => {\n  const [currentPage, setCurrentPage] = useState(1);\n  const [isLoading, setIsLoading] = useState(false);\n  const [modal, setModal] = useState({ show: false, title: '', message: '', isSuccess: false });\n  const [dbInstance, setDbInstance] = useState(null);\n  const [userId, setUserId] = useState(null);\n  \n  // State data form utama\n  const [formData, setFormData] = useState({\n    customer: { firstName: '', lastName: '', phone: '', carBrand: '', carModel: '', color: '' },\n    inspection: { \n      'Cat Mobil': { status: 'G', notes: '', file: null },\n      'Panel Bodi': { status: 'G', notes: '', file: null },\n      'Kaca': { status: 'G', notes: '', file: null },\n      'Ban': { status: 'G', notes: '', file: null },\n      'Pelek': { status: 'G', notes: '', file: null },\n    },\n    signature: '',\n    agreed: false,\n    date: new Date().toISOString(),\n  });\n\n  // --- FIREBASE INIT & AUTH ---\n  useEffect(() => {\n    if (auth && db) {\n      const initializeAuth = async () => {\n        try {\n          if (initialAuthToken) {\n            await signInWithCustomToken(auth, initialAuthToken);\n          } else {\n            await signInAnonymously(auth);\n          }\n        } catch (error) {\n          console.error(\"Firebase auth failed:\", error);\n          // Fallback to anonymous sign-in if custom token fails\n          try {\n             await signInAnonymously(auth);\n          } catch(anonError) {\n             console.error(\"Anonymous sign-in failed:\", anonError);\n          }\n        }\n      };\n\n      initializeAuth();\n\n      // Listener untuk mendapatkan ID pengguna setelah autentikasi\n      const unsubscribe = auth.onAuthStateChanged((user) => {\n        if (user) {\n          setUserId(user.uid);\n          setDbInstance(db);\n          console.log(\"Authenticated with UID:\", user.uid);\n        } else {\n          // Hanya set userId jika auth sudah ready dan tidak ada user (anon)\n          setUserId(crypto.randomUUID()); \n          setDbInstance(db);\n        }\n      });\n      return () => unsubscribe();\n    } else {\n        // Jika Firebase tidak terinisialisasi, set ID acak untuk userId\n        setUserId(crypto.randomUUID());\n    }\n  }, []);\n\n  // Handler perubahan form generik\n  const handleFormChange = (section, key, value) => {\n    if (section === 'root') {\n      setFormData(prev => ({\n        ...prev,\n        [key]: value\n      }));\n    } else if (section === 'inspection') {\n        // Untuk inspection, 'key' adalah nama item, dan 'value' adalah objek detail {status, notes, file}\n        setFormData(prev => ({\n            ...prev,\n            inspection: {\n                ...prev.inspection,\n                [key]: value\n            }\n        }));\n    } else {\n      // Untuk customer\n      setFormData(prev => ({\n        ...prev,\n        [section]: {\n          ...prev[section],\n          [key]: value\n        }\n      }));\n    }\n  };\n\n  const goToNextPage = () => setCurrentPage(prev => prev + 1);\n  const goToPrevPage = () => setCurrentPage(prev => prev - 1);\n  const closeModal = () => setModal({ show: false, title: '', message: '', isSuccess: false });\n\n  // Handler Submit\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n\n    if (!formData.agreed) {\n      setModal({ show: true, title: 'Error', message: 'Anda harus menyetujui Syarat & Ketentuan.', isSuccess: false });\n      return;\n    }\n\n    if (!formData.signature) {\n      setModal({ show: true, title: 'Error', message: 'Tanda tangan pelanggan tidak boleh kosong.', isSuccess: false });\n      return;\n    }\n\n    if (isLoading || !userId) return;\n\n    setIsLoading(true);\n    let firestoreSuccess = true;\n\n    try {\n      // 1. Filter Data URL Gambar yang valid dan hapus input file mentah\n      const dataToSend = JSON.parse(JSON.stringify(formData));\n      \n      // Hapus Data URL yang besar jika tidak ada, atau saring hanya yang dibutuhkan\n      Object.keys(dataToSend.inspection).forEach(item => {\n        if (dataToSend.inspection[item].file) {\n          // Pastikan hanya mengirim name dan dataUrl\n          dataToSend.inspection[item].file = {\n            name: dataToSend.inspection[item].file.name,\n            dataUrl: dataToSend.inspection[item].file.dataUrl\n          };\n        }\n      });\n      \n      // 2. Simpan ke Firestore (hanya jika dbInstance ada)\n      if (dbInstance) {\n        try {\n            const inspectionCollectionRef = collection(dbInstance, getCollectionPath(userId, 'inspections'));\n            await addDoc(inspectionCollectionRef, dataToSend);\n            console.log(\"Data berhasil disimpan ke Firestore.\");\n        } catch (error) {\n            console.error(\"Gagal menyimpan data ke Firestore:\", error);\n            firestoreSuccess = false;\n        }\n      } else {\n          console.warn(\"Firebase Firestore tidak terinisialisasi. Data tidak disimpan.\");\n          firestoreSuccess = false;\n      }\n      \n      // 3. Panggil backend untuk membuat dan mengunduh PDF (selalu coba panggil)\n      await fetchPdf(dataToSend);\n      \n      // Tampilkan modal sukses\n      const successMessage = firestoreSuccess \n        ? 'Inspeksi berhasil ditambahkan dan PDF akan diunduh.' \n        : 'Inspeksi berhasil diunduh. (Penyimpanan ke database gagal).';\n\n      setModal({ show: true, title: 'Success', message: successMessage, isSuccess: true });\n      \n      // Reset form setelah berhasil\n      setFormData({\n        customer: { firstName: '', lastName: '', phone: '', carBrand: '', carModel: '', color: '' },\n        inspection: { \n          'Cat Mobil': { status: 'G', notes: '', file: null },\n          'Panel Bodi': { status: 'G', notes: '', file: null },\n          'Kaca': { status: 'G', notes: '', file: null },\n          'Ban': { status: 'G', notes: '', file: null },\n          'Pelek': { status: 'G', notes: '', file: null },\n        },\n        signature: '',\n        agreed: false,\n        date: new Date().toISOString(),\n      });\n      setCurrentPage(1);\n\n    } catch (error) {\n      // Catch error dari fetchPdf (hanya jika semua retry gagal)\n      console.error(\"Submission failed:\", error);\n      setModal({ show: true, title: 'Error', message: 'Gagal memproses inspeksi. (Gagal unduh PDF atau masalah database). Silakan coba lagi.', isSuccess: false });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const fetchPdf = async (data) => {\n    // Implementasi logic unduh PDF dari backend\n    console.log(\"Mencoba fetch PDF dari backend...\");\n\n    const apiUrl = `/api/generate-pdf`; \n    let attempt = 0;\n    const maxRetries = 3;\n    const baseDelay = 1000;\n\n    // Fungsi delay\n    const delay = (ms) => new Promise(resolve => setTimeout(resolve, ms));\n\n    while (attempt < maxRetries) {\n      try {\n        const response = await fetch(apiUrl, {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify(data),\n        });\n\n        if (!response.ok) {\n          const errorText = await response.text();\n          throw new Error(`HTTP error! status: ${response.status}. Details: ${errorText}`);\n        }\n\n        // Ambil nama file dari header Content-Disposition (jika ada)\n        const contentDisposition = response.headers.get('Content-Disposition');\n        let filename = 'inspection_report.pdf';\n        if (contentDisposition) {\n          const match = contentDisposition.match(/filename=\"(.+)\"/);\n          if (match && match[1]) {\n            filename = match[1];\n          }\n        }\n\n        const blob = await response.blob();\n        const url = window.URL.createObjectURL(blob);\n        const a = document.createElement('a');\n        a.href = url;\n        a.download = filename;\n        document.body.appendChild(a);\n        a.click();\n        a.remove();\n        window.URL.revokeObjectURL(url);\n        \n        console.log(\"PDF berhasil diunduh.\");\n        return; // Keluar dari loop jika berhasil\n\n      } catch (error) {\n        console.error(`Attempt ${attempt + 1} failed:`, error);\n        attempt++;\n        if (attempt < maxRetries) {\n          const delayTime = baseDelay * Math.pow(2, attempt - 1); // Exponential backoff\n          await delay(delayTime);\n        } else {\n          // Tampilkan pesan error kepada pengguna jika semua retry gagal\n          throw new Error(\"PDF download failed after retries. Check Node.js backend server.\"); \n        }\n      }\n    }\n  };\n\n\n  // --- Render Halaman ---\n  const renderPage = () => {\n    switch (currentPage) {\n      case 1:\n        return <CustomerForm formData={formData} handleFormChange={handleFormChange} goToNext={goToNextPage} />;\n      case 2:\n        return <InspectionForm formData={formData} handleFormChange={handleFormChange} goToNext={goToNextPage} goToPrev={goToPrevPage} />;\n      case 3:\n        return (\n          <form onSubmit={handleSubmit} className=\"p-6 bg-white rounded-xl shadow-lg\">\n            <h2 className=\"text-2xl font-extrabold text-indigo-700 mb-6 flex items-center\">\n              <FileText size={24} className=\"mr-3\"/> 3. Syarat & Ketentuan & Tanda Tangan\n            </h2>\n\n            {/* Syarat & Ketentuan Placeholder */}\n            <div className=\"bg-gray-100 p-4 rounded-lg h-64 overflow-y-scroll border border-gray-200 text-sm text-gray-700 space-y-2 mb-6\">\n              <p className=\"font-bold text-center mb-3\">SYARAT DAN KETENTUAN - SERAH TERIMA KENDARAAN DI WRAP STATION</p>\n              <ol className=\"list-decimal list-inside space-y-1\">\n                <li>Kondisi kendaraan dapat berubah setelah pembersihan. Tim akan menginformasikan jika ada perubahan.</li>\n                <li>Status cat kendaraan (repaint/original) tidak dapat dipastikan, risiko ditanggung pemilik.</li>\n                <li>Penambahan jarak tempuh (mileage) bisa terjadi, dan bukan tanggung jawab Wrap Station.</li>\n                <li>Kerusakan/malfungsi mesin selama atau setelah pengerjaan bukan tanggung jawab Wrap Station.</li>\n                <li>Kerusakan akibat pembongkaran aksesori oleh pemilik selama atau setelah pengerjaan bukan tanggung jawab Wrap Station.</li>\n                <li>Kehilangan barang pribadi bukan tanggung jawab Wrap Station.</li>\n                <li>Wrap Station berhak melakukan tindakan teknis yang diperlukan tanpa persetujuan lebih lanjut.</li>\n                <li>Kondisi/modifikasi khusus yang tidak diinformasikan di awal dapat membatalkan garansi.</li>\n                <li>Penurunan baterai EV adalah kondisi alami, bukan tanggung jawab kami.</li>\n                <li>Estimasi pengerjaan dapat berubah karena faktor tak terduga.</li>\n              </ol>\n            </div>\n\n            <SignatureForm \n              formData={formData} \n              handleFormChange={handleFormChange} \n              onSubmit={handleSubmit} \n              isLoading={isLoading}\n            />\n\n            <div className=\"flex justify-between mt-8\">\n              <button\n                onClick={goToPrevPage}\n                type=\"button\"\n                className=\"px-6 py-3 bg-gray-300 text-gray-800 font-bold rounded-xl shadow-md hover:bg-gray-400 transition duration-150\"\n              >\n                &larr; Sebelumnya\n              </button>\n              <button\n                type=\"submit\"\n                // Hanya disable jika belum setuju ATAU belum ada tanda tangan\n                disabled={isLoading || !formData.agreed || !formData.signature}\n                className={`px-8 py-3 font-bold rounded-xl shadow-lg transition duration-150 flex items-center justify-center ${\n                  isLoading || !formData.agreed || !formData.signature\n                    ? 'bg-indigo-300 cursor-not-allowed text-gray-100' // Tambahkan text-gray-100 untuk visibilitas\n                    : 'bg-indigo-600 text-white hover:bg-indigo-700'\n                }`}\n              >\n                {isLoading ? (\n                  <>\n                    <Car size={20} className=\"animate-pulse mr-2\"/> Membuat PDF...\n                  </>\n                ) : (\n                  'Submit Inspection & Download PDF'\n                )}\n              </button>\n            </div>\n          </form>\n        );\n      default:\n        return <div>Halaman Tidak Ditemukan</div>;\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gray-100 p-4 sm:p-8 font-sans\">\n      <header className=\"mb-8 p-4 bg-white rounded-xl shadow-md\">\n        <h1 className=\"text-2xl sm:text-3xl font-extrabold text-indigo-800 flex items-center\">\n          <Car size={32} className=\"mr-3\"/> Wrap Station - Form Inspeksi Kendaraan\n        </h1>\n        <div className=\"mt-2 text-sm text-gray-500\">\n          User ID: {userId || 'Authenticating...'}\n        </div>\n      </header>\n      \n      <main className=\"max-w-4xl mx-auto\">\n        {renderPage()}\n      </main>\n\n      {modal.show && <Modal {...modal} onClose={closeModal} />}\n    </div>\n  );\n};\n\nexport default App;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}